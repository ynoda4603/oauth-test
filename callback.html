<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Salesforce Callback</title>
</head>
<body>
  <h1>アクセストークンを取得しました</h1>
  <div id="result"></div>

  <script>
    function getHashParams() {
      const hash = window.location.hash.substring(1); // 先頭の # を除去
      const params = new URLSearchParams(hash);
      return {
        accessToken: params.get('access_token'),
        instanceUrl: params.get('instance_url'),
        tokenType: params.get('token_type'),
        expiresIn: params.get('expires_in'),
        state: params.get('state'),
        scope: params.get('scope')
      };
    }

    (function () {
      const resultEl = document.getElementById('result');
      const tokenData = getHashParams();

      if (!tokenData.accessToken) {
        resultEl.innerText = 'アクセストークンが取得できませんでした。';
        return;
      }

      console.log('アクセストークン取得成功:', tokenData);
      resultEl.innerText = `アクセストークン取得成功！\n\n${JSON.stringify(tokenData, null, 2)}`;

      // 必要ならこのあと Salesforce REST API を呼び出すこともできます
    })();
  </script>
</body>
</html>
